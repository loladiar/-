#!/usr/bin/env jruby # called `tame-corpus`
puts ARGV[0]
puts ARGV[1]

case ARGV[0].to_i
  when 1
    system 's3cmd get s3://${S3_BUCKET}-private/resources/rrc_pro_22110.csv ${MAHOUT_WORK}/corpus-1.csv' unless File.exist?("ENV['MAHOUT_WORK']/corpus-1.csv")
    system 'prep-comm-text ${MAHOUT_WORK}/corpus-1.csv -d ${MAHOUT_WORK}/comm-text-ext -i 3 -f 4,11'
  when 2
  when 3
  else
# case $1 in
#   1) 
#     [ ! -e ${MAHOUT_WORK}/corpus-1.csv ] && s3cmd get s3://${S3_BUCKET}-private/resources/rrc_pro_22110.csv ${MAHOUT_WORK}/corpus-1.csv;
#     prep-comm-text ${MAHOUT_WORK}/corpus-1.csv -d ${MAHOUT_WORK}/comm-text-ext -i 3 -f 4,11
#     ;;
#   2)
#     [ ! -e ${MAHOUT_WORK}/corpus-2.csv ] && s3cmd get s3://${S3_BUCKET}-private/resources/rrc_ind_31771.csv ${MAHOUT_WORK}/corpus-2.csv;
#     prep-comm-text ${MAHOUT_WORK}/corpus-2.csv -d ${MAHOUT_WORK}/comm-text-ext -i 3 -f 4,11
#     ;;
#   3)
#     [ ! -e ${MAHOUT_WORK}/corpus-l.csv ] && s3cmd get s3://${S3_BUCKET}-private/resources/rrc_pro_2285_labeled_typos.csv ${MAHOUT_WORK}/corpus-l.csv;
#     prep-comm-text ${MAHOUT_WORK}/corpus-l.csv -d ${MAHOUT_WORK}/comm-text-ext -i 4 -l 8 -f 1,3
#     ;;
# esac
# 
# $HADOOP dfs -rmr ${MAHOUT_WORK}/comm-text-ext ${MAHOUT_WORK}/comm-text-seq
# $HADOOP dfs -put ${MAHOUT_WORK}/comm-text-ext/corpus-priors ${MAHOUT_WORK}/comm-text-ext/corpus-priors
# $HADOOP dfs -put ${MAHOUT_WORK}/comm-text-ext/corpus ${MAHOUT_WORK}/comm-text-ext/corpus
# $MAHOUT seqdirectory -i ${MAHOUT_WORK}/comm-text-ext/corpus -o ${MAHOUT_WORK}/comm-text-seq -ow -chunk 5
end
